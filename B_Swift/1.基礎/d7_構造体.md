# 構造体



## 構造体

構造体(struct)は複数の属性を持ったデータを型として定義する

クラスと列挙型と同じく、プロパティやメソッド、

さらにイニシャライザ、サブスクリプトを作れる



### 定義

```swift
struct 名前 {
   static let 定数:型 = 値
   static var 変数:型 = 値
   let 定数:型 = 値
   var 変数:型 = 値
}
```

定義場所：

* クラス定義の外：グローバルな列挙型となる
* クラス定義の中：そのクラス内でのみ有効
* メソッド定義の中：そのメソッド内でのみ有効



### 構造体を作る

```swift
struct ColorBox {
   var width:Int
   var height:Int
   var color:String
}
let redBox = ColorBox(width:120, height:100, color:"red")

struct WhiteBox {
   var width:Int = 100
   var height:Int = 100
   let color:String = "white"
}
let whiteBox01 = WhiteBox()	// 初期値あるので省略可
let whiteBox01 = WhiteBox(width:120, height:100)
```



### 値の参照と変更

```swift
redBox.width = 200
print(redBox.width)
```



### 構造体のコピー

クラスは参照のコピー

構造体は値のコピー



### クラスと列挙型の共通点

* イニシャライザ

  ```swift
  struct Box {
     let width:Int
     let height:Int
     let size:String
     
     init(width:Int, height:Int){
        self.width = width
        self.height = height
        size = "unknown"
     }
     
  }
  ```

* メソッド

  クラスや列挙型のように定義できる

  また、メソッドで自身の値を変更する場合、列挙型と同じく、`mutating`をつける

  ```swift
  struct name {
     
     // 自分の値を変更するには、mutatingをつける
     mutating func funcName(){
        .....
     }
     
  }
  ```

  

### subscriptの定義

subscriptを定義することで、`name[1]`や`name["a",2]`のように構造体の要素をアクセスできる

```swift
struct 名前 {
   
   subscript(引数:型) -> 戻り値の型 {
      get {
         // プロパティの値を返す
         return 値
      }
      set {
         // 設定値 (newValue) を処理して
         // プロパティに設定
      }
   }
}
```

例：

```swift
struct Stock {
   var name:String
   var data:[String:Int] = [:]
   
   init(name:String){
      self.name = name
   }
   
   subscript(color:String, size:Double) -> Int {
      get{
         let key = color + String(size)
         if let value = data[key] {
            return value
         } else {
            return 0
         }
      }
      set{
         let key = color + String(size)
         data[key] = newValue
         // newValueにサブスクリプトで渡された値が入っている
      }
   }
   
}


var shoes = Stock(name: "Adidas")
// 値を登録
shoes["green", 24.5] = 3
shoes["green", 25.0] = 5
// 在庫を更新
shoes["green", 24.5] -= 2
shoes["green", 25.0] += 1
shoes["red", 26.0] = 5
// 在庫を確認
print(shoes.name)					// Adidas
print(shoes["green", 24.5])	// 1
print(shoes["green", 25.0])	// 6
print(shoes["red", 26.0])		// 5
// 在庫データがないもの
print(shoes["red", 25.5])		// 0
print(shoes["white", 25.0])	// 0
```



### 構造体でプロトコルを採用

```swift
protocol Monster {
   var monsterName:String {get}
   var hp:Int {get set}
   mutating func updateHP(pt:Int)
}

struct Pokemon: Monster {
   // プロトコルではread onlyなので、setを制限
   private(set) var monsterName:String
   var hp:Int
   mutating func updateHP(pt:Int){
      hp += pt
   }
}

var pikachu = Pokemon(monsterName:"ピカチュー", hp:200)
pikachu.updateHP(30)			// hpが230に
```

















