# ロール＆権限

## Linuxのファイル

Linuxでは、==ほとんどのシステムエンティティはファイルとして扱われる==。

システムを構造化したりコンピュータ内の境界を再定義したりするために、Linuxではファイルの権限が使用される。

ファイルの権限は、ファイルシステム構造に組み込まれており、各ファイルに対する権限を定義するためのメカニズムを提供する。

Linux のすべてのファイルにはファイルの権限が指定され、

==所有者、グループ、その他のユーザ==がファイルに対して実行できるアクションが定義される。

使用可能な権限は、==読み取り、書き込み、実行==である。 

ls コマンドを -l パラメータとともに使用すると、ファイルに関する追加情報が一覧表示される。

```shell
ls -l パス
```

## ファイルの情報

```shell
❯  ls -l aaa.txt
-rwxrw-r-- 1 yechentide  wheel  200  2  5 17:31 aaa.txt
```

* 第１フィールド：-rwxrw-r--
    * 最初の`-`：ファイルであることを示す。ディレクトリの場合は`d`
    * 2~ 4 個目の`rwx`：所有者の権限。ファイルのR(読み取り)、W(書き込み)、X(実行)権限がある
    * 5~ 7 個目の`rw-`：グループの権限。ファイルのR(読み取り)、W(書き込み)権限がある
    * 8~10個目の`r--`：他のユーザ＆グループの権限。ファイルのR(読み取り)権限がある

* 第２フィールド：1

    ファイルのハードリンクの数を表す。

    > ハードリンク
    >
    > >ファイルシステム内の同じ場所にリンクされた異なる名前の別のファイルを作成する

* 第３フィールド：yechentide

    ファイル所有者

* 第４フィールド：wheel

    グループ

* 第５フィールド：200

    ファイルサイズ

* 第６フィールド：2 5 17:31

    最終変更日時

* 第７フィールド：aaa.txt

    ファイル名

## ファイルの権限

ファイルの権限は、Linuxに欠かせない要素で、違反することはできない。

ユーザは、ファイルのアクセス許可と同様に多くの権利を持っている。

Linuxコンピュータでファイルのアクセス許可を上書きできるユーザは、rootユーザのみである。

rootユーザはファイルのアクセス許可を上書きできるため、rootユーザは任意のファイルに書き込むことができる。

Linuxではすべてがファイルとして扱われるため、rootユーザはLinuxコンピュータの完全な制御権を持っている。

多くの場合、メンテナンスや管理タスクを実行する前にrootアクセスが必要になる。

## ファイルのリンク

### ハードリンク

```shell
ln 既存のファイル 新ファイル
```

* 元のファイルまたはディレクトリの==inodeを参照==するディレクトリエントリ
* 一方のファイルを変更すると、もう一方のファイルも変更される。
* 元のファイルを移動しても影響無し
* 元のファイルを削除しても削除されない
* 同一ファイルシステム内のみ参照可能

### シンボリックリンク　(シンリンク)　(ソフトリンク)

```shell
ln -s 既存のファイル 新ファイル
```

* 元のファイルまたはディレクトリの==パスを参照==するディレクトリエントリ
* 一方のファイルを変更すると、もう一方のファイルも変更される

* 元ファイルを移動すると参照できなくなる
* 元ファイルを削除すると削除される
* 別のファイルシステムでも参照できる
* シングルポイント障害（基盤のファイル）がある

### シンボリックリンクの利点

1. ハードリンクの方が元ファイルの特定が困難である。シンボリックリンクの場合は`ls -l`で確認できる。
2. シンボリックリンクは別のファイルシステムでファイルにリンクできる。
3. シンボリックリンクは、ディレクトリにリンクできる。