### サーバー構築作業の概要

* OSをインストールして設定

   セキュリティ設定、ユーザーの追加など

* 必要なソフトウェアをインストールする

   | 使い道             | ソフトウェア                          |
   | ------------------ | ------------------------------------- |
   | Webサーバ          | Apache, nginx など                    |
   | プログラミング言語 | PHP, Ruby, Java など                  |
   | データベース       | MariaDB, MySQL, PostgreSQL など       |
   | フレームワーク     | Ruby on Rails, Symphony2, Django など |
   | CMS                | WordPress, Mediawiki など             |

* ソフトウェアを適切に設定する



### 時間設定

```
# timedatectl set-timezone Asia/Tokyo
# systemctl reboot
```



### SSH設定

* 設定ファイルの場所：　**/etc/ssh/sshd_config**
* 変更箇所
   1. `Port 50505`
   2. `PermitRootLogin no`
   3. `PasswordAuthentication yes`



### ユーザー管理

* ログイン中に別のユーザーに切り替える

   ```
   su [-] [ユーザー名]
   ```

   1. ユーザー名を省略する＝root
   2. オプション - を指定すると、新規ログインとなる(つまり、ホームディレクトリが変わる)
   3. exitコマンドで元のユーザーに戻る

* 管理者コマンドを一般ユーザーに使わせる   ---sudo---

   **/etc/sudoersを編集してはいけない！！！**		visudoコマンドで設定する

   visudo

   末尾に、「 ユーザー名 ホスト名=(実行ユーザー名) 許可するコマンド 」

   例：　mc ALL=(ALL) ALL

   sudoのログは、 /var/log/secure などに残る



### ソフトウェアのインストール＆アップデート

* RPM

* DNF・・・ YUMの後継システム、CentOS 8から実装した

   `dnf -y update`
   
   `dnf -y install vim wget tmux jq`



### スケジュールの管理

指定したコマンドを定期的に実行する・・・ `crontab` コマンド

yum-cronサービスが有効になってるかを確認

```
# systemctl is-active yum-cron
# crontab [オプション]
```

| オプション |               効果               |
| :--------: | :------------------------------: |
|     -e     |    スケジュール設定を編集する    |
|     -l     |    スケジュール設定を表示する    |
|     -r     | 全てのスケジュール設定を削除する |



```
# crontab -e
```

`* * * * * /usr/bin/uptime >> /home/mc/log.txt`

書式：　`分　時　日　月　曜日　実行コマンド`		( `*`は全て )

例：

```
3 * * * *			// 毎時３分
23 30 * * *			// 毎日23:30
23 30 * * 0			// 0:日曜　〜　6:土曜
*/5 * * * *			// ５分ごと
```



コマンド以外に、設定ファイルを編集するのも一つの方法

crontab関連の設定ファイル＆ディレクトリ：

|       パス        |                   機能                   |
| :---------------: | :--------------------------------------: |
|   /etc/crontab    |        システム全体のスケジュール        |
|    /etc/cron.d    | 個別の設定ファイルを格納するディレクトリ |
| /etc/cron.hourly  | １時間ごとに実行する設定ファイルの居場所 |
|  /etc/cron.daily  |  １日ごとに実行する設定ファイルの居場所  |
| /etc/cron.weekly  | １週間ごとに実行する設定ファイルの居場所 |
| /etc/cron.monthly | １ヶ月ごとに実行する設定ファイルの居場所 |



**anacron**

* crontab：システム停止中のスケジュールを後から実行しない

* anacron：システム停止中のスケジュールを後から実行する

   指定した範囲内でタイミングをずらして実行してくれる

























