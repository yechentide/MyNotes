## 基本的なサーバー管理



### システム負荷の確認

```
# uptime
```

* 出力：

   `23:17:55 up 2 days,  6:55,  1 user,  load average: 0.00, 0.01, 0.05`

* 解説：

   load average欄に３つの数値がある。過去１分間、５分間、１５分間、におけるシステム負荷だ。この数値がCPUコア数以下だったら、大丈夫。



### ディスクの使用状況の確認

```
# df [-h]
```

* 出力：

   ```
   Filesystem     1K-blocks    Used Available Use% Mounted on
   /dev/vda1       41147472 9205528  30038452  24% /
   devtmpfs          930656       0    930656   0% /dev
   tmpfs             941116       0    941116   0% /dev/shm
   ```

* 解説：

   ファイルシステムごとに表示される。-hをつけないと kb 単位、つけると Gb/Mb 単位。
   tmpfsは仮想的なファイルシステムなので、無視して良い。
   Usedは利用中のサイズ、Availableは使用可能なサイズ、Use%は利用率



### メモリ＆スワップの確認

```
# free [-h]
```

* 出力：

   ```
                 total        used        free      shared  buff/cache   available
   Mem:           1.8G        153M        476M        456K        1.2G        1.5G
   Swap:            0B          0B          0B
   ```

* 解説：
   -h については上と同じ。
   スワップは仮想的なメモリで、物理メモリが不足の時に使われるディスク上の領域だ。
   buff/cacheはバッファ＆キャッシュのこと。

   メモリとディスクのアクセス速度の差を小さくする。



### 実行中のプロセスの確認

* lessでみる

   ```
   # ps aux | less
   ```

* grepは、指定した文字列が含まれる行だけを抜き出すコマンド

   ```
   # ps aux | grep ssh	
   ```



### システムの状態をモニター

```
# top
```

* 出力：

   １行目はuptimeコマンドの実行結果
   ４〜５行目はfreeコマンドの実行結果
   ６行目以降はpsコマンドの実行結果			と同じ
   3秒間隔で更新される
   終了するにはキーq



### サービスの管理

サービス：OS本体から切り離し可能な、サブシステムのこと
サービスを管理するには `systemctl` コマンドを使う。

```
# systemctl サブサービス サービス名
```

* 主なサブサービス

   |  名称   |                           効果                           |
   | :-----: | :------------------------------------------------------: |
   |  start  |                    サービスを開始する                    |
   |  stop   |                    サービスを停止する                    |
   | restart |                   サービスを再起動する                   |
   | enable  |       システム起動時に、サービスを自動的に開始する       |
   | disable | システム起動時に、サービスを自動的に開始しないようにする |
   | status  |                 サービスの状態を表示する                 |

* 主なサービス
  
   .serviceはほとんどの場合に省略可
   
   |       名称        | 効果 |
   | :---------------: | :--: |
   | firewalld.service |      |
   |   crond.service   |      |
   |   cups.service    |      |
   |  postfix.service  |      |
   |  rsyslog.service  |      |
   |   sshd.service    |      |
   |   httpd.service   |      |

















